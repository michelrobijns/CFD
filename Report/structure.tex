\section{Structure of the Navier-Stokes Equations}

Recall the system of equations derived in Chapter \ref{cha:physics}:
\begin{flalign}
    \stepcounter{equation}
    \tag{{\theequation}a}
    &\text{Continuity equation:}& &\vphantom{\frac{\partial}{\partial}} \nabla \cdot \mathbf{u} = 0 && \\
    \tag{{\theequation}b}
    &\text{Velocity-vorticity relation:}& &\vphantom{\frac{\partial}{\partial}} \xi = \nabla \times \mathbf{u} && \\
    \tag{{\theequation}c}
    &\text{Momentum equation:}& &\frac{\partial \mathbf{u}}{\partial t} - \mathbf{u} \times \xi + \nabla P + \frac{1}{\text{Re}} \nabla \times \xi = 0 &&
\end{flalign}
Let us first add superscripts to denote the dimensions of the $k$-cochains:
\begin{align}
    \stepcounter{equation}
    \tag{{\theequation}a}
    &\nabla \cdot \mathbf{u}^{(1)} = 0 \vphantom{\frac{\partial^{(1)}}{\partial}} \label{eq:continuityCochains} \\
    \tag{{\theequation}b}
    &\xi^{(2)} = \nabla \times \mathbf{u}^{(1)} \vphantom{\frac{\partial^{(1)}}{\partial}} \label{eq:velocityVorticityCochains} \\
    \tag{{\theequation}c}
    &\frac{\partial \mathbf{u}^{(1)}}{\partial t} - \mathbf{u}^{(1)} \times \xi^{(2)} + \nabla P^{(0)} + \frac{1}{\text{Re}} \nabla \times \xi^{(2)} = 0 \label{eq:momentumCochains}
\end{align}
To make these equations consistent, all terms within an equation must be reduced to $k$-cells of the same dimension \emph{and} orientation. For example, it is not allowed to equate 2-cochains and 1-cochains, let alone of different orientations.

\subsection{Continuity Equation}

The continuity equation, Equation \eqref{eq:continuityCochains}, involves the divergence operator. The divergence operator is equivalent to a $\xymatrix{*+[o][F-]{1}}$ mapping of velocity to mass flow and a $\xymatrix{*+[o][F-]{2}}$ subsequent application of the curl operator. These two operations are annotated in the double DeRham complex: 
\begin{equation}
    \begin{gathered}
        \xymatrix@=20ex{
            \mathbf{P}^{(0)} \ar[r]^{\mathbb{E}^{(1,0)}}_{\text{grad}} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{2},0)}} & \mathbf{u}^{(1)} \ar[r]^{\mathbb{E}^{(2,1)}}_{\text{curl}} \ar @/^10ex/ @{-->} [d]|-*+[o][F-]{1} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{1},1)}} & \mathbf{\xi}^{(2)} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{0},2)}} \\
            \mathbf{\tilde{S}}^{(2)} \ar@<1ex>[u]^{\mathbb{H}^{(0,\tilde{2})}} & \mathbf{\tilde{u}}^{(1)} \ar[l]_{\tilde{\mathbb{E}}^{(2, 1)}}^{\text{curl}} \ar @/_6ex/ @{-->} [l]|-*+[o][F-]{2} \ar@<1ex>[u]^{\mathbb{H}^{(1,\tilde{1})}} & \mathbf{\tilde{\psi}}^{(0)} \ar[l]_{\tilde{\mathbb{E}}^{(1,0)}}^{\text{grad}} \ar@<1ex>[u]^{\mathbb{H}^{(2,\tilde{0})}}
        }
    \end{gathered}
    \label{eq:DeRhamMassConservation}
\end{equation}
Thus, Equation (3.13a) is equivalent to
\begin{equation}
    \tilde{\mathbb{E}}^{(2,1)} \mathbb{H}^{(\tilde{1},1)} \mathbf{u}^{(1)} = 0
\end{equation}
which is in turn equivalent to writing $\mathbf{\tilde{S}}^{(2)} = 0$. Recall that the physical interpretation of $\mathbf{\tilde{S}}$ is the rate of mass production within the planes that compose the mesh. Thus, $\mathbf{\tilde{S}}^{(2)} = 0$ implies that the net production of mass equals zero, which is precisely what the continuity equation tells us.

\subsection{Velocity-Vorticity relation}

The velocity-vorticity relation states that vorticity, $\mathbf{\xi}$, is equal to the curl of velocity, $\mathbf{u}$. This represents a mapping from an inner-oriented 1-cochain to an inner-oriented 2-cochain. This operation is represented by a single jump in the double DeRham complex, denoted $\xymatrix{*+[o][F-]{1}}$ in the double DeRham complex:
\begin{equation}
    \begin{gathered}
        \xymatrix@=20ex{
            \mathbf{p}^{(0)} \ar[r]^{\mathbb{E}^{(1,0)}}_{\text{grad}} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{2},0)}} & \mathbf{u}^{(1)} \ar[r]^{\mathbb{E}^{(2,1)}}_{\text{curl}} \ar @/^6ex/ @{-->} [r]|-*+[o][F-]{1} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{1},1)}} & \mathbf{\xi}^{(2)} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{0},2)}} \\
            \mathbf{\tilde{s}}^{(2)} \ar@<1ex>[u]^{\mathbb{H}^{(0,\tilde{2})}} & \mathbf{\tilde{u}}^{(1)} \ar[l]_{\tilde{\mathbb{E}}^{(2, 1)}}^{\text{curl}} \ar@<1ex>[u]^{\mathbb{H}^{(1,\tilde{1})}} & \mathbf{\tilde{\psi}}^{(0)} \ar[l]_{\tilde{\mathbb{E}}^{(1,0)}}^{\text{grad}} \ar@<1ex>[u]^{\mathbb{H}^{(2,\tilde{0})}}
        }
    \end{gathered}
    \label{eq:DeRhamVelocityVorticity}
\end{equation}
Equation \ref{eq:velocityVorticityCochains} can therefore be written as
\begin{equation}
    \xi^{(2)} = \mathbb{E}^{(2,1)} \mathbf{u}^{(1)}
\end{equation}

\subsection{Momentum Equation}

The momentum equation involves three terms that must be expressed in terms of incidence and Hodge matrices:
\begin{enumerate}
    \item $\mathbf{u}^{(1)} \times \mathbf{\xi}^{(2)}$
    \item $\nabla P^{(0)}$
    \item $\nabla \times \mathbf{\xi}^{(2)}$
\end{enumerate}


The cross product $\mathbf{u}^{(1)} \times \mathbf{\xi}^{(2)}$ represents the nonlinear convective term of the Navier-Stokes equations and is a bit of a special case. We will therefore replace the nonlinear term by a generic vector named ``convective'', to be derived at a later stage.

The pressure gradient, $\nabla P^{(0)}$, represents a mapping from an inner-oriented 0-cochain to an inner-oriented 1-cochain. This mapping is denoted $\xymatrix{*+[o][F-]{1}}$  in the double DeRham complex:
\begin{equation}
    \begin{gathered}
        \xymatrix@=20ex{
            \mathbf{p}^{(0)} \ar[r]^{\mathbb{E}^{(1,0)}}_{\text{grad}} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{2},0)}} \ar @/^6ex/ @{-->} [r]|-*+[o][F-]{1}  & \mathbf{u}^{(1)} \ar[r]^{\mathbb{E}^{(2,1)}}_{\text{curl}} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{1},1)}} & \mathbf{\xi}^{(2)} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{0},2)}} \\
            \mathbf{\tilde{s}}^{(2)} \ar@<1ex>[u]^{\mathbb{H}^{(0,\tilde{2})}} & \mathbf{\tilde{u}}^{(1)} \ar[l]_{\tilde{\mathbb{E}}^{(2, 1)}}^{\text{curl}} \ar@<1ex>[u]^{\mathbb{H}^{(1,\tilde{1})}} & \mathbf{\tilde{\psi}}^{(0)} \ar[l]_{\tilde{\mathbb{E}}^{(1,0)}}^{\text{grad}} \ar@<1ex>[u]^{\mathbb{H}^{(2,\tilde{0})}}
        }
    \end{gathered}
    \label{eq:DeRhamPressure}
\end{equation}

The third term, the curl of vorticity or the curl of the curl of velocity, is less straighforward. Both velocity and vorticity are vector fields. Within the realms of ordinary calculus, there would be no difference between the two. However, within the realms of discrete exterior calculus, there is an important distinction: velocity is an integral value associated with lines whereas vorticity is an integral value associated with surfaces. So the only way to apply the curl operator to velocity a second time is to take a slight detour accross the double DeRham complex. First, apply the curl operator to velocity as usual, denoted $\xymatrix{*+[o][F-]{1}}$. Second, map vorticity to its outer oriented counterpart, the stream function, denoted $\xymatrix{*+[o][F-]{2}}$. Third, apply the gradient operator (which is the transpose of the curl operator, $\mathbb{E}^{(2,1)}$, as we shall soon see) to obtain mass flow, denoted $\xymatrix{*+[o][F-]{3}}$. Last but not least, map the mass flow to velocity, denoted $\xymatrix{*+[o][F-]{4}}$, because we eventually want all quantities in the momentum equation to be expressed in terms of velocity. This chain of mappings is graphically depicted in the double DeRham complex:
\begin{equation}
    \begin{gathered}
        \xymatrix@=20ex{
            \mathbf{p}^{(0)} \ar[r]^{\mathbb{E}^{(1,0)}}_{\text{grad}} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{2},0)}} & \mathbf{u}^{(1)} \ar[r]^{\mathbb{E}^{(2,1)}}_{\text{curl}} \ar @/^6ex/ @{-->} [r]|-*+[o][F-]{1} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{1},1)}} & \mathbf{\xi}^{(2)} \ar@<1ex>[d]^{\mathbb{H}^{(\tilde{0},2)}} \ar @/^10ex/ @{-->} [d]|-*+[o][F-]{2} \\
            \mathbf{\tilde{s}}^{(2)} \ar@<1ex>[u]^{\mathbb{H}^{(0,\tilde{2})}} & \mathbf{\tilde{u}}^{(1)} \ar[l]_{\tilde{\mathbb{E}}^{(2, 1)}}^{\text{curl}} \ar@<1ex>[u]^{\mathbb{H}^{(1,\tilde{1})}} \ar @/^10ex/ @{-->} [u]|-*+[o][F-]{4} & \mathbf{\tilde{\psi}}^{(0)} \ar[l]_{\tilde{\mathbb{E}}^{(1,0)}}^{\text{grad}} \ar @/_6ex/ @{-->} [l]|-*+[o][F-]{3} \ar@<1ex>[u]^{\mathbb{H}^{(2,\tilde{0})}}
        }
    \end{gathered}
\end{equation}

Hence, Equation \ref{eq:momentumCochains} can be written as
\begin{equation}
    \frac{\partial \mathbf{u}^{(1)}}{\partial t} + \text{convective}^{(1)} - \mathbb{E}^{(1,0)} P^{(0)} + \frac{1}{\text{Re}} \mathbb{H}^{(1,\tilde{1})} \tilde{\mathbb{E}}^{(1,0)} \mathbb{H}^{(\tilde{0},2)} \mathbb{E}^{(2,1)} \mathbf{u}^{(1)} = 0
\end{equation}

\subsection{Summary}

The Navier-Stokes equations are rewritten in terms of incidence matrices and Hodge matrices, as follows:
\begin{align}
    \stepcounter{equation}
    \tag{{\theequation}a}
    &\tilde{\mathbb{E}}^{(2,1)} \mathbb{H}^{(\tilde{1},1)} \mathbf{u}^{(1)} = 0 \vphantom{\frac{\partial^{(1)}}{\partial}} \\
    \tag{{\theequation}b}
    &\xi^{(2)} = \mathbb{E}^{(2,1)} \mathbf{u}^{(1)} \vphantom{\frac{\partial^{(1)}}{\partial}} \\
    \tag{{\theequation}c}
    &\frac{\partial \mathbf{u}^{(1)}}{\partial t} + \text{convective}^{(1)} - \mathbb{E}^{(1,0)} P^{(0)} + \frac{1}{\text{Re}} \mathbb{H}^{(1,\tilde{1})} \tilde{\mathbb{E}}^{(1,0)} \mathbb{H}^{(\tilde{0},2)} \mathbb{E}^{(2,1)} \mathbf{u}^{(1)} = 0
\end{align}
