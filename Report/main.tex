\documentclass[a4paper, 11pt, toc=bibliography, parskip=half]{scrreprt}

\usepackage[automark, headsepline]{scrpage2}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage[all,cmtip]{xy}
\usepackage{mathrsfs}
\usepackage[top=1in,bottom=1in,left=1.6in,right=1.6in]{geometry}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usepackage{listings}

\usepackage[defernumbers=true, backend=biber, hyperref=true, sorting=none]{biblatex}
\addbibresource{bibliography.bib}
\setlength{\headheight}{1.1\baselineskip}
\setlength{\bibitemsep}{\baselineskip}

\clearscrheadfoot
\pagestyle{scrheadings}
\ihead{\rightmark}
\ohead{\pagemark}
\cfoot[\pagemark]{}

\usepackage{libertine}
\usepackage[libertine]{newtxmath}
\usepackage{inconsolata}

\newlength{\MaxSizeOfLineNumbers}%
\settowidth{\MaxSizeOfLineNumbers}{9}% Adjust to maximum number of lines
\addtolength{\MaxSizeOfLineNumbers}{2.8ex}%

\lstset{basicstyle=\ttfamily,
    aboveskip=\bigskipamount,
    belowskip=\bigskipamount,
    belowcaptionskip=\bigskipamount,
    breaklines=true,
    breakatwhitespace=true,
    numbers=left,
    numberstyle=\small,
    xleftmargin=\MaxSizeOfLineNumbers
}

\setcounter{tocdepth}{1}
%\setkomafont{disposition}{\bfseries}
\renewcommand{\labelstyle}{\textstyle}
\setcounter{MaxMatrixCols}{40}
\newlength{\myl}
\settowidth{\myl}{$-1$}
\newcommand\w[1]{\makebox[\myl]{$#1$}}
\let\d\cdot

\begin{document}

\titlehead{Delft University of Technology}
\subject{AE4134 - CFD I}
\title{Computational Fluid Dynamics}
\subtitle{\vspace{2cm}\centering\includegraphics[width=0.8\linewidth]{Images/streamFunction.pdf}\vspace{1.5cm}}
\author{Michel Robijns (Student ID: 4088018)}
\date{\today}

\maketitle

\tableofcontents

\chapter{Objective}

\input{objective.tex}

\chapter{Physics}
\label{cha:physics}

In this chapter, we will derive the governing equations and introduce the domain on which they are imposed, as well as the associated boundary conditions and initial values. The governing equations must be expressed in terms of certain operators for reasons that will be the subject of Chapter \ref{cha:mathematics}. I chose to re-derive the governing equations to understand their origin and to verify their correctness.

\input{equations.tex}
\input{problem.tex}

\chapter{Mathematics}
\label{cha:mathematics}

In Chapter \ref{cha:physics} we derived a system of dimensionless partial differential equations that govern the motion of viscous fluids. In this chapter, we cover some mathematical machinery to formulate the problem into a format understandable by a computer. Instead of using classical discretization methods like the finite difference method, we take a geometric approach using tools from discrete exterior calculus (DEC). A key ingredient in this geometric approach is the placement of physical quantities on the appropriate geometric structures. DEC is a vast mathematical field and a rigorous treatment is far beyond the scope of this assignment. The scope of this chapter is therefore limited to those particular concepts that are required to solve the lid-driven cavity flow problem.

\input{theory.tex}
\input{discretization.tex}
\input{structure.tex}
\input{matrices.tex}
\input{time.tex}

\chapter{Code}
\label{cha:code}

In Chapter \ref{cha:physics} we derived a system of dimensionless partial differential equations that govern the motion of viscous fluids and in Chapter \ref{cha:mathematics} we presented a framework that enables a computer to solve these equations. In this chapter, we will look at the implementation of this framework in \texttt{Python} and \texttt{C}. As is the case with most numerical simulations, the program can take a long time to run if reasonable accuracy is desired. Thankfully, there is vast potential for speedup if common sense and simple optimization techniques are applied. For instance, simply rearranging parts of the code results in a speedup factor of more than 10 without a loss of accuracy.

\input{loop.tex}
\input{naive.tex}
\input{optimizations.tex}

\chapter{Results}
\label{cha:results}

\input{results.tex}

\chapter{Conclusion}
\label{cha:conclusion}

\input{conclusion.tex}

\printbibliography[heading=bibintoc, title={References}]

\end{document}
